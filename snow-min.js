window.snowStorm=function(e,t){const n={version:1,autoStart:!0,excludeMobile:!0,flakesMax:200,useGPU:!0,snowColors:["#fff","#ececf2","#7792a7","#e7eaef","#bfcbd3"],snowStick:!0,useMeltEffect:!0,useTwinkleEffect:!1,followMouse:!1,flakeSize:2,vMaxX:1.5,vMaxY:1.5,zIndex:9999,checkForHitEveryPixel:2,snowShape:"circle",emoji:"❄️",character:"❄️",sizeJitter:1};let o,a,i,l={...n},r=[],c=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),s=[],f=[],h=0;async function m(){const e=function(){const e={},n=t.currentScript;n&&n.src&&new URL(n.src).searchParams.forEach(((t,n)=>{e[n]=t}));return e}();let o;if("true"===e.preview&&e.config)o=JSON.parse(decodeURIComponent(e.config));else{if(!e.token)return n;try{o=await async function(e){const t=await fetch(`https://ijgyqpqtsauyluefxvvb.supabase.co/functions/v1/get-config?token=${e}`,{headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlqZ3lxcHF0c2F1eWx1ZWZ4dnZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxMDMyMTcsImV4cCI6MjA1ODY3OTIxN30.fn6Uc1EWGeMbGufBQWQzCLHFSI_ElmA8-ZjOMJL2raM"}});if(!t.ok)throw new Error("Failed to fetch configuration");return await t.json()}(e.token)}catch(e){return n}}return{...n,...o}}function u(){s=Array.from(t.querySelectorAll("h1")),h=Math.max(t.body.scrollHeight,t.documentElement.scrollHeight,t.body.offsetHeight,t.documentElement.offsetHeight)}function d(){const t=Math.floor(Math.random()*s.length);let n=Math.random()*o.width,a=-l.flakeSize;if(Math.random()<.3&&s.length>0){const o=s[t].getBoundingClientRect(),i=o.top+e.scrollY;i>e.scrollY+e.innerHeight&&(n=o.left+Math.random()*o.width,a=i-200*Math.random()-50,a<e.scrollY+e.innerHeight&&(a=e.scrollY-l.flakeSize))}return{x:n,y:a,vX:(Math.random()-.5)*l.vMaxX,vY:Math.random()*l.vMaxY,active:!0,accumule:!1,meltFrame:0,twinkleFrame:0,h1Cible:t,offsetX:0,offsetY:0,lastY:a,color:l.snowColors[Math.floor(Math.random()*l.snowColors.length)],rayon:l.flakeSize*(1+(Math.random()-.5)*l.sizeJitter)}}function M(t){for(let n=0;n<s.length;n++){const o=s[n].getBoundingClientRect(),a={left:o.left,right:o.right,top:o.top+e.scrollY,bottom:o.bottom+e.scrollY};if(t.x>=a.left&&t.x<=a.right&&t.y>=a.top&&t.lastY<a.top)return t.h1Cible=n,t.accumule=!0,t.offsetX=t.x-o.left,t.offsetY=0,f.push(t),!0}return!1}function x(){a.clearRect(0,0,o.width,o.height);const t=e.scrollY,n=t+e.innerHeight;r.forEach((e=>{if(e.active&&!e.accumule&&(e.lastY=e.y,e.x+=1*e.vX,e.y+=e.vY,l.snowStick&&Math.abs(e.y-e.lastY)>=l.checkForHitEveryPixel&&(M(e),e.lastY=e.y),(e.y>h||e.x<-50||e.x>o.width+50)&&y(e)),l.useTwinkleEffect&&e.active&&!e.accumule?(a.globalAlpha=.5+.5*Math.sin(e.twinkleFrame*Math.PI/10),e.twinkleFrame=(e.twinkleFrame+1)%20):a.globalAlpha=1,e.active&&!e.accumule&&e.y>=t-100&&e.y<=n+100)if("circle"===l.snowShape)a.beginPath(),a.arc(e.x,e.y-t,e.rayon,0,2*Math.PI),a.fillStyle=e.color,a.fill();else if("emoji"===l.snowShape||"character"===l.snowShape){const n="emoji"===l.snowShape?l.emoji:l.character;a.font=2*e.rayon+"px Arial",a.fillStyle=e.color,a.fillText(n,e.x-e.rayon,e.y-t)}if(l.useMeltEffect&&e.active&&Math.random()>.998&&(e.meltFrame=1),e.meltFrame>0&&(e.rayon-=.2,e.meltFrame++,e.rayon<=0)){if(e.accumule){const t=f.indexOf(e);-1!==t&&f.splice(t,1)}y(e)}l.snowStick&&Math.abs(e.y-e.lastY)>=l.checkForHitEveryPixel&&(M(e),e.lastY=e.y)})),f.forEach((e=>{if(e.h1Cible>=s.length)return;const t=s[e.h1Cible].getBoundingClientRect(),n=t.left+e.offsetX,i=t.top+e.offsetY;if(i>=2*-e.rayon&&i<=o.height+2*e.rayon)if("circle"===l.snowShape)a.beginPath(),a.arc(n,i,e.rayon,0,2*Math.PI),a.fillStyle=e.color,a.fill();else if("emoji"===l.snowShape||"character"===l.snowShape){const t="emoji"===l.snowShape?l.emoji:l.character;a.font=2*e.rayon+"px Arial",a.fillStyle=e.color,a.fillText(t,n-e.rayon,i)}}));const c=r.filter((e=>e.active&&!e.accumule)).length;if(c<l.flakesMax){const e=Math.min(l.flakesMax-c,Math.floor(5*Math.random())+1);for(let t=0;t<e;t++)if(r.length<l.flakesMax)r.push(d());else{const e=r.filter((e=>!e.active));if(e.length>0){const t=Math.floor(Math.random()*e.length);y(e[t]),e[t].active=!0}}}i=requestAnimationFrame(x)}function y(t){if(t.accumule){const e=f.indexOf(t);-1!==e&&f.splice(e,1),t.accumule=!1}const n=function(){if(Math.random()<.7||0===s.length)return{x:Math.random()*o.width,y:-l.flakeSize,h1Index:Math.floor(Math.random()*Math.max(1,s.length))};{const t=Math.floor(Math.random()*s.length),n=s[t].getBoundingClientRect(),o=n.top+e.scrollY;return{x:n.left+Math.random()*n.width,y:Math.max(-l.flakeSize,o-200*Math.random()-50),h1Index:t}}}();t.x=n.x,t.y=n.y,t.vX=(Math.random()-.5)*l.vMaxX,t.vY=Math.random()*l.vMaxY+1,t.rayon=l.flakeSize*(1+(Math.random()-.5)*l.sizeJitter),t.active=!0,t.meltFrame=0,t.twinkleFrame=0,t.h1Cible=n.h1Index,t.lastY=n.y,t.color=l.snowColors[Math.floor(Math.random()*l.snowColors.length)]}function g(){u(),r=[],f=[];for(let e=0;e<l.flakesMax;e++){const t=d();e<l.flakesMax/3&&(t.y=Math.random()*h),r.push(t),e>=l.flakesMax&&(t.active=!1)}}function v(){o.width=e.innerWidth,o.height=e.innerHeight,u()}function w(e){l.followMouse&&r.forEach((t=>{if(t.active&&!t.accumule){const n=e.clientX-t.x;t.vX+=.01*n,t.vX=Math.max(-l.vMaxX,Math.min(l.vMaxX,t.vX))}}))}function p(){l.excludeMobile&&c||(o=t.getElementById("snowCanvas")||null,o||(o=t.createElement("canvas"),o.id="snowCanvas",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.pointerEvents="none",o.style.zIndex=l.zIndex,t.body.appendChild(o)),o.width=e.innerWidth,o.height=e.innerHeight,a=o.getContext("2d",{alpha:!0}),u(),g(),x(),e.removeEventListener("resize",v),e.addEventListener("resize",v),e.removeEventListener("scroll",u),e.addEventListener("scroll",u),l.followMouse&&(e.removeEventListener("mousemove",w),e.addEventListener("mousemove",w)))}function k(){cancelAnimationFrame(i),i=null}return async function(){l=await m(),!l.autoStart||l.excludeMobile&&c||p()}(),{start:p,stop:k,updateConfig:function(e){const t=l.flakesMax;l={...l,...e},l.flakesMax!==t&&g(),k(),p()},get config(){return l}}}(window,document);