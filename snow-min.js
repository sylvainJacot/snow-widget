(()=>{function X(){let a={},t=document.currentScript;return t&&t.src&&new URL(t.src).searchParams.forEach((i,h)=>{a[h]=i}),a}async function O(a){let t=await fetch(`https://ijgyqpqtsauyluefxvvb.supabase.co/functions/v1/get-config?token=${a}`,{headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlqZ3lxcHF0c2F1eWx1ZWZ4dnZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDMxMDMyMTcsImV4cCI6MjA1ODY3OTIxN30.fn6Uc1EWGeMbGufBQWQzCLHFSI_ElmA8-ZjOMJL2raM"}});if(!t.ok){if(t.status===403)return console.error("Abonnement inactif ou expir\xE9. Veuillez renouveler votre abonnement."),null;throw console.error("R\xE9ponse API non valide :",t.status,t.statusText),new Error("Failed to fetch configuration")}let r=await t.json();return console.log("Donn\xE9es API :",r),r}async function z(a){let t=X(),r;if(t.preview==="true"&&t.config)r=JSON.parse(decodeURIComponent(t.config));else if(t.token)try{if(r=await O(t.token),!r)return console.error("Impossible de charger la configuration : abonnement invalide."),a}catch(i){return console.error("Erreur lors de la r\xE9cup\xE9ration de la configuration :",i),a}else return console.error("Aucun token ou configuration preview fourni"),a;return{...a,...r}}var o,F;function Y(a){o=document.getElementById("snowCanvas")||null,o||(o=document.createElement("canvas"),o.id="snowCanvas",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.pointerEvents="none",o.style.zIndex=a.zIndex,document.body.appendChild(o)),o.width=window.innerWidth,o.height=window.innerHeight,F=o.getContext("2d",{alpha:!0})}function S(a,t,r){let i=Math.floor(Math.random()*a.length),h=Math.random()*r.width,m=-t.flakeSize;if(Math.random()<.3&&a.length>0){let d=a[i].getBoundingClientRect(),u=d.top+window.scrollY;u>window.scrollY+window.innerHeight&&(h=d.left+Math.random()*d.width,m=u-Math.random()*200-50,m<window.scrollY+window.innerHeight&&(m=window.scrollY-t.flakeSize))}return{x:h,y:m,vX:(Math.random()-.5)*t.maxHorizontalSpeed,vY:Math.random()*t.maxVerticalSpeed,active:!0,accumule:!1,meltFrame:0,twinkleFrame:0,h1Cible:i,offsetX:0,offsetY:0,lastY:m,color:t.flakeColors[Math.floor(Math.random()*t.flakeColors.length)],rayon:t.flakeSize*(1+(Math.random()-.5)*t.sizeVariation)}}function E(a,t,r,i){if(t.accumule){let m=i.indexOf(t);m!==-1&&i.splice(m,1),t.accumule=!1}let h=r();t.x=h.x,t.y=h.y,t.vX=(Math.random()-.5)*a.maxHorizontalSpeed,t.vY=Math.random()*a.maxVerticalSpeed+1,t.rayon=a.flakeSize*(1+(Math.random()-.5)*a.sizeVariation),t.active=!0,t.meltFrame=0,t.twinkleFrame=0,t.h1Cible=h.h1Index,t.lastY=h.y,t.color=a.flakeColors[Math.floor(Math.random()*a.flakeColors.length)]}function g(a,t,r,i,h,m,n,d,u,x,k){n.clearRect(0,0,d.width,d.height),n.globalAlpha=r.opacity;let c=window.scrollY,w=c+window.innerHeight;a.forEach(e=>{if(e.active&&!e.accumule&&(e.lastY=e.y,e.x+=e.vX*u,e.y+=e.vY,r.stickyEffect&&Math.abs(e.y-e.lastY)>=r.pixelCheckInterval&&(i(e),e.lastY=e.y),(e.y>k||e.x<-50||e.x>d.width+50)&&h(r,e,m,t)),r.twinkleEffect&&e.active&&!e.accumule?(n.globalAlpha=.5+.5*Math.sin(e.twinkleFrame*Math.PI/10),e.twinkleFrame=(e.twinkleFrame+1)%20):n.globalAlpha=1,e.active&&!e.accumule&&e.y>=c-100&&e.y<=w+100){if(r.flakeShape==="circle")n.beginPath(),n.arc(e.x,e.y-c,e.rayon,0,Math.PI*2),n.fillStyle=e.color,n.fill();else if(r.flakeShape==="emojiCharacter"){n.font=`${e.rayon*2}px Arial`;n.fillStyle=e.color,n.fillText(r.emojiCharacter,e.x-e.rayon,e.y-c)}}if(r.meltEffects&&e.active&&Math.random()>.998&&(e.meltFrame=1),e.meltFrame>0&&(e.rayon-=.2,e.meltFrame++,e.rayon<=0)){if(e.accumule){let y=t.indexOf(e);y!==-1&&t.splice(y,1)}h(r,e,m,t)}r.stickyEffect&&Math.abs(e.y-e.lastY)>=r.pixelCheckInterval&&(i(e),e.lastY=e.y)}),t.forEach(e=>{if(e.h1Cible>=x.length)return;let f=x[e.h1Cible].getBoundingClientRect(),p=f.left+e.offsetX,v=f.top+e.offsetY;if(v>=-e.rayon*2&&v<=d.height+e.rayon*2){if(r.flakeShape==="circle")n.beginPath(),n.arc(p,v,e.rayon,0,Math.PI*2),n.fillStyle=e.color,n.fill();else if(r.flakeShape==="emojiCharacter"){n.font=`${e.rayon*2}px Arial`;n.fillStyle=e.color,n.fillText(r.emojiCharacter,p-e.rayon,v)}}});let b=a.filter(e=>e.active&&!e.accumule).length;if(b<r.maxFlakes){let e=Math.min(r.maxFlakes-b,Math.floor(Math.random()*5)+1);for(let y=0;y<e;y++)if(a.length<r.maxFlakes)a.push(createFlocon(x,r,d));else{let f=a.filter(p=>!p.active);if(f.length>0){let p=Math.floor(Math.random()*f.length);h(r,f[p],m,t),f[p].active=!0}}}animationFrameId=requestAnimationFrame(()=>g(a,t,r,i,h,m,n,d,u,x,k))}function A(a){let t=new Date,r=a.startDate?new Date(a.startDate):null,i=a.endDate?new Date(a.endDate):null;return r&&i?t>=r&&t<=i:r?t>=r:i?t<=i:!0}window.snowStorm=function(a,t){let r={opacity:1,maxFlakes:200,flakeColors:["#fff","#ececf2","#7792a7","#e7eaef","#bfcbd3"],flakeShape:"circle",emojiCharacter:"\u2744\uFE0F",flakeSize:2,sizeVariation:1,autoStart:!0,maxHorizontalSpeed:1.5,maxVerticalSpeed:1.5,mouseInteraction:!1,stickyEffect:!0,meltEffects:!0,twinkleEffect:!1,startDate:null,endDate:null,disableOnMobile:!0,useGPU:!0,zIndex:9999,pixelCheckInterval:2},i={...r},h=[],m,n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),d=1,u=[],x=[],k=0;(async function(){i=await z(r),A(i)&&i.autoStart&&(!i.disableOnMobile||!n)&&p()})();function c(){u=Array.from(t.querySelectorAll("h1")),k=Math.max(t.body.scrollHeight,t.documentElement.scrollHeight,t.body.offsetHeight,t.documentElement.offsetHeight)}function w(s){for(let l=0;l<u.length;l++){let M=u[l].getBoundingClientRect(),I={left:M.left,right:M.right,top:M.top+a.scrollY,bottom:M.bottom+a.scrollY};if(s.x>=I.left&&s.x<=I.right&&s.y>=I.top&&s.lastY<I.top)return s.h1Cible=l,s.accumule=!0,s.offsetX=s.x-M.left,s.offsetY=0,x.push(s),!0}return!1}function b(){if(Math.random()<.7||u.length===0)return{x:Math.random()*o.width,y:-i.flakeSize,h1Index:Math.floor(Math.random()*Math.max(1,u.length))};{let l=Math.floor(Math.random()*u.length),M=u[l].getBoundingClientRect(),I=M.top+a.scrollY;return{x:M.left+Math.random()*M.width,y:Math.max(-i.flakeSize,I-Math.random()*200-50),h1Index:l}}}function e(){c(),h=[],x=[];for(let s=0;s<i.maxFlakes;s++){let l=S(u,i,o);s<i.maxFlakes/3&&(l.y=Math.random()*k),h.push(l),s>=i.maxFlakes&&(l.active=!1)}}function y(){o.width=a.innerWidth,o.height=a.innerHeight,c()}function f(s){i.mouseInteraction&&h.forEach(l=>{if(l.active&&!l.accumule){let C=s.clientX-l.x;l.vX+=C*.01,l.vX=Math.max(-i.maxHorizontalSpeed,Math.min(i.maxHorizontalSpeed,l.vX))}})}function p(){i.disableOnMobile&&n||(Y(i),c(),e(),g(h,x,i,w,E,b,F,o,d,u,k),a.removeEventListener("resize",y),a.addEventListener("resize",y),a.removeEventListener("scroll",c),a.addEventListener("scroll",c),i.mouseInteraction&&(a.removeEventListener("mousemove",f),a.addEventListener("mousemove",f)))}function v(){cancelAnimationFrame(m),m=null}function H(s){let l=i.maxFlakes;i={...i,...s},i.maxFlakes!==l&&e(),v(),p()}return{start:p,stop:v,updateConfig:H,get config(){return i}}}(window,document);})();
//! est-ce qu'on mettre inherit ou non?
